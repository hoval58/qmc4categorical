linewidth = 1.2
) +
# Scales
scale_x_continuous(trans = 'log2', breaks = 2^seq(3, 12, by = 1)) +
scale_y_continuous(
trans = 'log2',
breaks = 10^seq(-9, -1, by = 2),
labels = scales::label_scientific(digits = 3)
) +
scale_color_manual(values = c(
"MC" = "blue",
"RQMC" = "chartreuse4",
"RQMC adjusted" = "brown4",
"RQMC L independent" = "darkviolet",
"RQMC powers of 2" = "deeppink",
"Slope = -1" = "steelblue",
"Slope = -2" = "green",
"Slope = -3" = "pink"
)) +
scale_linetype_manual(values = c(
"Slope = -1" = "dashed",
"Slope = -2" = "dashed",
"Slope = -3" = "dashed"
)) +
scale_shape_manual(values = c(
"MC" = 19,                 # solid circle
"RQMC" = 17,               # triangle
"RQMC adjusted" = 8,      # square
"RQMC L independent" = 18, # diamond
"RQMC powers of 2" = 15     # plus
)) +
# Labels and guides
labs(
x = "Sample Size",
y = "Variance",
color = NULL,
shape = NULL,
linetype = NULL
) +
guides(
color = guide_legend(override.aes = list(
linetype = c("solid", "solid", "solid", "solid", "solid", "dashed", "dashed", "dashed"),
shape = c(19, 17, 8, 18, 15, NA, NA, NA)
)),
shape = "none",   # remove duplicate legend
linetype = "none"
) +
theme_minimal() +
theme(
axis.text = element_text(size = 11),
axis.title = element_text(size = 12),
legend.position = c(0.02, 0.02),
legend.justification = c("left", "bottom"),
legend.text = element_text(size = 12),
legend.key.size = unit(0.8, "lines"),
legend.background = element_rect(fill = "white", color = "gray80", linewidth = 0.3),
legend.margin = margin(6, 6, 6, 6),
plot.margin = margin(10, 10, 10, 10)
)
global_results_plot
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/figures/variances_toy.png")
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,4)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,4)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Flood_Example/flood_model.R")
source("Flood_Example/plot_results_flood.R")
#fixed parameters of the Saint-Venant flood model
B=300 #fixed
L=5000
s=5 #dimension of thw random vectors: 1 for selecting the stratum + 4 for sampling the 4 variables
#parameters of the Frechet and Gamma distributions in the mixture
alphas<-c(0.95,0.02,0.02,0.01) #mixture weights
shape_Q<-c(6,6,6,6)
scale_Q<-c(1300,3900,1300,3900)
shape_K<-c(90,90,15,15)
scale_K<-c(1/3,1/3,1,1)
m_list=seq(3,12) #sample sizes
n_rep=500 #number of replicates
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,4)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,4)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
sample_sizes <- 2^seq(3, 4)
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,4)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
sample_sizes <- 2^seq(3, 4)
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,12)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
print(m_list[[j]])
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
sample_sizes <- 2^seq(3, 12)
plot_variance(var_mc_list,var_plain_rqmc_list,var_rqmc_pow2_list,
var_rqmc_adjusted_list,var_rqmc_indep_list, sample_sizes,
file = "Toy_Example/toy_results/variances_toy.png")
source("Toy_Example/toy_functions.R")
source("Toy_Example/plot_results_toy.R")
if (!dir.exists("toy_results")) dir.create("toy_results")
alphas=c(0.5,0.44,0.01,0.01,0.01,0.01,0.01,0.01)
thetas=c(0.7,1,1.5,1.6,1.7,1.8,1.9,2)
s=2 #dimension needed for all are random vectors: the first to allocate, the second to sample
m_list=seq(3,12)
n_rep=500
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,theta_list=thetas, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,theta_list=thetas, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,theta_list=thetas, seed=i,rho=3)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
source("Flood_Example/flood_model.R")
source("Flood_Example/plot_results_flood.R")
dir.create("Flood_Example/flood_results", recursive = TRUE, showWarnings = FALSE)
#fixed parameters of the Saint-Venant flood model
B=300 #fixed
L=5000
s=5 #dimension of thw random vectors: 1 for selecting the stratum + 4 for sampling the 4 variables
#parameters of the Frechet and Gamma distributions in the mixture
alphas<-c(0.95,0.02,0.02,0.01) #mixture weights
shape_Q<-c(6,6,6,6)
scale_Q<-c(1300,3900,1300,3900)
shape_K<-c(90,90,15,15)
scale_K<-c(1/3,1/3,1,1)
m_list=seq(3,12) #sample sizes
n_rep=500 #number of replicates
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
source("Flood_Example/flood_model.R")
source("Flood_Example/plot_results_flood.R")
dir.create("Flood_Example/flood_results", recursive = TRUE, showWarnings = FALSE)
#fixed parameters of the Saint-Venant flood model
B=300 #fixed
L=5000
s=5 #dimension of thw random vectors: 1 for selecting the stratum + 4 for sampling the 4 variables
#parameters of the Frechet and Gamma distributions in the mixture
alphas<-c(0.95,0.02,0.02,0.01) #mixture weights
shape_Q<-c(6,6,6,6)
scale_Q<-c(1300,3900,1300,3900)
shape_K<-c(90,90,15,15)
scale_K<-c(1/3,1/3,1,1)
m_list=seq(3,12) #sample sizes
n_rep=500 #number of replicates
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
getAnywhere(qfrechet)
source("Flood_Example/flood_model.R")
source("Flood_Example/plot_results_flood.R")
dir.create("Flood_Example/flood_results", recursive = TRUE, showWarnings = FALSE)
#fixed parameters of the Saint-Venant flood model
B=300 #fixed
L=5000
s=5 #dimension of thw random vectors: 1 for selecting the stratum + 4 for sampling the 4 variables
#parameters of the Frechet and Gamma distributions in the mixture
alphas<-c(0.95,0.02,0.02,0.01) #mixture weights
shape_Q<-c(6,6,6,6)
scale_Q<-c(1300,3900,1300,3900)
shape_K<-c(90,90,15,15)
scale_K<-c(1/3,1/3,1,1)
m_list=seq(3,12) #sample sizes
n_rep=500 #number of replicates
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
R.version
R.version.string
detach("package:ordinal", unload = TRUE)
source("Flood_Example/flood_model.R")
source("Flood_Example/plot_results_flood.R")
dir.create("Flood_Example/flood_results", recursive = TRUE, showWarnings = FALSE)
#fixed parameters of the Saint-Venant flood model
B=300 #fixed
L=5000
s=5 #dimension of thw random vectors: 1 for selecting the stratum + 4 for sampling the 4 variables
#parameters of the Frechet and Gamma distributions in the mixture
alphas<-c(0.95,0.02,0.02,0.01) #mixture weights
shape_Q<-c(6,6,6,6)
scale_Q<-c(1300,3900,1300,3900)
shape_K<-c(90,90,15,15)
scale_K<-c(1/3,1/3,1,1)
m_list=seq(3,12) #sample sizes
n_rep=500 #number of replicates
var_mc_list<-list()
var_plain_rqmc_list<-list()
var_rqmc_adjusted_list<-list()
var_rqmc_pow2_list<-list()
var_rqmc_indep_list<-list()
for (j in 1:length(m_list)){
cat("Running Plot 1 m =", m_list[[j]], "\n")
mu_list_mc<-list()
mu_list_plain_rqmc<-list()
mu_list_rqmc_adjusted<-list()
mu_list_rqmc_pow2<-list()
mu_list_rqmc_indep<-list()
for(i in 1:n_rep){
mu_list_mc[[i]]<-compute_estimator(m_list[j],setting="mc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_plain_rqmc[[i]]<-compute_estimator(m_list[j],setting="plain-rqmc",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i)
mu_list_rqmc_adjusted[[i]]<-compute_estimator(m_list[j],setting="rqmc-adjusted",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_pow2[[i]]<-compute_estimator(m_list[j],setting="rqmc-pow2",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
mu_list_rqmc_indep[[i]]<-compute_estimator(m_list[j],setting="rqmc-indep",alpha_list=alphas,shape_K,scale_K,shape_Q,scale_Q, seed=i,rho=2)
}
var_mc_list[[j]]<-var(unlist(mu_list_mc))
var_plain_rqmc_list[[j]]<-var(unlist(mu_list_plain_rqmc))
var_rqmc_adjusted_list[[j]]<-var(unlist(mu_list_rqmc_adjusted))
var_rqmc_pow2_list[[j]]<-var(unlist(mu_list_rqmc_pow2))
var_rqmc_indep_list[[j]]<-var(unlist(mu_list_rqmc_indep))
}
